@model ProductViewModel

<form asp-page="/Basket/Index" asp-page-handler="addtobasket" method="post">
    <div class="dama-product-title">@Model.ProductTitle</div>
    <div class="row justify-content-center mt-3 mt-md-3">
        <div class="dama-product-price">
            <span>@Model.ProductPrice</span>
        </div>
    </div>
    <div class="text-center my-3 my-sm-3 mt-md-3 mb-md-3">
        <img class="separator"  src="~/images/barra-coracao.png" />
    </div>r

    @if (Model.ProductReferences.Any())
    {
        <div class="row dama-product-attr mb-2 mb-md-3">
            <label class="col-2 col-form-label">Tamanho</label>
            <div class="col-10">
                <select id="referenceProducts" class="form-control" asp-items="Model.ProductReferences"></select>
            </div>
        </div>
    }

    @for (int i = 0; i < Model.Attributes.Count; i++)
    {
        <input type="hidden" asp-for="Attributes[i].AttributeType" />
        <div class="row dama-product-attr mb-2 mb-md-3">
            <label class="col-2 col-form-label">@Model.Attributes[i].Label</label>
            <div class="col-10">
                <select asp-for="Attributes[i].Selected" class="form-control atribute-items" asp-items="Model.Attributes[i].Items">
                    <option value="-1">@Model.Attributes[i].DefaultText</option>
                </select>
                <span asp-validation-for="Attributes[i].Selected" class="text-danger"></span>
            </div>
        </div>
    }

    @if (Model.CanCustomize)
    {
        <div class="row align-items-center mb-4 mt-4">
            <div class="col-12 col-md-7 dama-customize-question mb-2 mb-sm-0">Queres personalizar com um nome?</div>
            <div class="col-12 col-md-5">
                <a class="btn btn-dama-menta w-100" role="button" data-toggle="collapse" href="#addName">ADICIONAR NOME</a>
            </div>
            <small id="nameInputText" class="text-muted ml-3 dama-small-text"></small>
            
        </div>
        <div id="addName" class="collapse mb-4">
            <div class="ml-3 ml-md-5">
                <div class="form-group mb-0">
                    <label for="exampleInputEmail1">Nome ou Frase</label>
                </div>
                <div class="form-group row">
                    <div class="col-7">
                        <input asp-for="NameInput" class="form-control dama-product-input" placeholder="escreve aqui" />
                        <span asp-validation-for="NameInput" class="text-danger"></span>

                    </div>
                    <div class="col-5 col-md-4">
                        <a id="saveName" class="btn btn-primary rounded-0 w-100" role="button" data-toggle="collapse" href="#addName">GRAVAR</a>
                    </div>
                    <div class="col">
                        <small class="text-muted dama-small-text">*Esta personalização tem um custo adicional de 2,90€</small>
                    </div>
                </div>
            </div>

        </div>
        <hr />
        <div class="row mb-4 mb-md-3 align-items-center">
            <div class="col-12 col-md-7 dama-customize-question  mb-2 mb-sm-0">Queres uma personalização total?</div>
            <div class="col-12 col-md-5">
                <a class="btn btn-dama-menta w-100 text-white" role="button" asp-page="/Customize/Index">PERSONALIZAR</a>
            </div>
        </div>
    }

    <div class="btn-group mt-md-4 w-100" role="group">
        <button id="btnSub" type="button" class="btn">-</button>
        <input asp-for="ProductQuantity" class="form-control col-2 text-center">
        <button id="btnAdd" type="button" class="btn">+</button>
        <input class="dama-product-add ml-2 w-100" type="submit" value="ADICIONAR" />
    </div>

    <small class="text-muted dama-small-text">Tempo de entrega entre @Model.DeliveryTimeMin a @Model.DeliveryTimeMax @(DamaWeb.Extensions.EnumHelper<ApplicationCore.Entities.DeliveryTimeUnitType>.GetDisplayValue(Model.DeliveryTimeUnit)) para produtos em stock.</small>

    <div class="text-center my-3 my-sm-3">
        <img class="separator" src="~/images/barra-coracao.png" />
    </div>

    <p class="dama-product-description my-3 my-sm-3">@Html.Raw(Model.ProductDescription)</p>

    <hr />
    <div class="row dama-product-attr mt-2 mt-md-4">
        <label asp-for="ProductSKU" class="col-3 col-form-label"></label>
        <div class="col-9">
            <span>@Model.ProductSKU</span>
        </div>
    </div>
    <div class="row dama-product-attr mt-md-2">
        <label class="col-3 col-form-label">Categorias:</label>
        <div class="col-9">
            @foreach (var item in Model.Categories)
            {
                <a asp-page="/Category/Index" asp-route-id="@item.TagName">@item.Name</a>
            }
        </div>
    </div>
    <div class="row dama-product-attr mt-md-2">
        <label class="col-3 col-form-label">Tags:</label>
        <div class="col-9">
            @foreach (var item in Model.Tags)
            {
                <a asp-page="/Tag/Index" asp-route-tagName="@item.Name" asp-route-q="@item.TagName">@item.Name</a>
                @if (item != Model.Tags.Last())
                {
                    <text>,</text>
                }
            }
        </div>
    </div>
    <input type="hidden" asp-for="ProductSKU" />
    <input type="hidden" asp-for="ProductId" />
    <input type="hidden" asp-for="ProductPrice" />
</form>